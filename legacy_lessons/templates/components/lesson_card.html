{% load lesson_filters %}
                <div class="lesson-view {% if forloop.first %}active{% endif %}" id="{{ lesson.data_lesson_id }}">
                    <div class="content-card">
                        <!-- Localized Title in Content -->
                        <h2 class="lesson-title lang-content lang-ru">
                            <span class="lesson-title-emoji">{{ lesson.title_ru|get_emoji }}</span>
                            <span class="lesson-title-text">{{ lesson.title_ru|get_text_after_emoji }}</span>
                        </h2>
                        <h2 class="lesson-title lang-content lang-ua">
                            <span class="lesson-title-emoji">{{ lesson.title_uk|default:lesson.title_ru|get_emoji }}</span>
                            <span class="lesson-title-text">{{ lesson.title_uk|default:lesson.title_ru|get_text_after_emoji }}</span>
                        </h2>
                        <h2 class="lesson-title lang-content lang-en">
                            <span class="lesson-title-emoji">{{ lesson.title_en|default:lesson.title_ru|get_emoji }}</span>
                            <span class="lesson-title-text">{{ lesson.title_en|default:lesson.title_ru|get_text_after_emoji }}</span>
                        </h2>
                        <h2 class="lesson-title lang-content lang-fr">
                            <span class="lesson-title-emoji">{{ lesson.title_fr|default:lesson.title_ru|get_emoji }}</span>
                            <span class="lesson-title-text">{{ lesson.title_fr|default:lesson.title_ru|get_text_after_emoji }}</span>
                        </h2>

                        <!-- Localized Content -->
                        <div class="lesson-body lang-content lang-ru">
                            {{ lesson.content_html_ru|safe }}
                        </div>
                        <div class="lesson-body lang-content lang-ua">
                            {{ lesson.content_html_uk|default:lesson.content_html_ru|safe }}
                        </div>
                        <div class="lesson-body lang-content lang-en">
                            {{ lesson.content_html_en|default:lesson.content_html_ru|safe }}
                        </div>
                        <div class="lesson-body lang-content lang-fr">
                            {{ lesson.content_html_fr|default:lesson.content_html_ru|safe }}
                        </div>

                        <!-- Quiz Section (Hidden by default) -->
                        <div class="quiz-container" id="quiz-{{ lesson.data_lesson_id }}" style="display: none;">
                            <div class="quiz-header">
                                <div class="quiz-meta">
                                    <span class="quiz-counter">1 / 1</span>
                                </div>
                                <div class="quiz-progress">
                                    <div class="quiz-progress-segments"></div>
                                </div>
                            </div>

                            <div class="quiz-questions">
                                {% for question in lesson.questions.all %}
                                <div class="quiz-question-card {% if forloop.first %}active{% endif %}" data-question-index="{{ forloop.counter0 }}">
                                    <h3 class="quiz-question-text">
                                        <span class="lang-content lang-ru">‚ùì {{ question.text_ru }}</span>
                                        <span class="lang-content lang-ua">‚ùì {{ question.text_uk }}</span>
                                        <span class="lang-content lang-en">‚ùì {{ question.text_en }}</span>
                                        <span class="lang-content lang-fr">‚ùì {{ question.text_fr }}</span>
                                    </h3>
                                    <div class="quiz-choices">
                                        {% for choice in question.choices.all %}
                                        <button class="quiz-choice-btn" 
                                                onclick="checkAnswer(this)"
                                                data-is-correct="{{ choice.is_correct|yesno:'true,false' }}">
                                            <span class="lang-content lang-ru">{{ choice.text_ru }}</span>
                                            <span class="lang-content lang-ua">{{ choice.text_uk }}</span>
                                            <span class="lang-content lang-en">{{ choice.text_en }}</span>
                                            <span class="lang-content lang-fr">{{ choice.text_fr }}</span>
                                        </button>
                                        {% endfor %}
                                    </div>
                                </div>
                                {% endfor %}
                            </div>

                            <div class="quiz-results" style="display: none;">
                                <div class="results-icon">üèÜ</div>
                                <h4 class="results-title">
                                    <span class="lang-content lang-ru">–†–µ–∑—É–ª—å—Ç–∞—Ç</span>
                                    <span class="lang-content lang-ua">–†–µ–∑—É–ª—å—Ç–∞—Ç</span>
                                    <span class="lang-content lang-en">Result</span>
                                    <span class="lang-content lang-fr">R√©sultat</span>
                                </h4>
                                <p class="results-score">0 / 0</p>
                                <button class="btn-next-lesson" onclick="confirmNextLesson()">
                                    <span class="lang-content lang-ru">–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫ ‚Üí</span>
                                    <span class="lang-content lang-ua">–ù–∞—Å—Ç—É–ø–Ω–∏–π —É—Ä–æ–∫ ‚Üí</span>
                                    <span class="lang-content lang-en">Next Lesson ‚Üí</span>
                                    <span class="lang-content lang-fr">Le√ßon suivante ‚Üí</span>
                                </button>
                            </div>
                        </div>

                        <!-- Navigation Buttons -->
                        <div class="lesson-footer-nav">
                            <button class="nav-btn prev" onclick="navigateLesson('prev')">
                                <span class="lang-content lang-ru">‚Üê –ù–∞–∑–∞–¥</span>
                                <span class="lang-content lang-ua">‚Üê –ù–∞–∑–∞–¥</span>
                                <span class="lang-content lang-en">‚Üê Back</span>
                                <span class="lang-content lang-fr">‚Üê Retour</span>
                            </button>
                            
                            <button class="nav-btn next" onclick="openNextModal()">
                                <span class="lang-content lang-ru">–î–∞–ª–µ–µ ‚Üí</span>
                                <span class="lang-content lang-ua">–î–∞–ª—ñ ‚Üí</span>
                                <span class="lang-content lang-en">Next ‚Üí</span>
                                <span class="lang-content lang-fr">Suivant ‚Üí</span>
                            </button>
                        </div>
                    </div>
                </div>
